---
title: "wr"
output: html_notebook
---
```{r Hochladen der Listen des Netzwerks}

library(igraph)
# load raw edges data ----
edgelist <- read.csv("https://raw.githubusercontent.com/weisse-rose/Weisse-Rose/master/edgelist.csv",header=T, as.is=T, sep=",")

# load raw nodes data ----
nodelist <- read.csv("https://raw.githubusercontent.com/weisse-rose/Weisse-Rose/master/nodelist.csv",header=T, as.is=T, sep=",")

# Überprüfen der Daten
head(edgelist)
head(nodelist)

# create network ----
edges <- as.matrix(edgelist)
nodes <- as.matrix(nodelist)
wr <-  graph_from_data_frame(d=edges,vertices=nodelist, directed=F)
plot(wr, main="Gesamtnetzwerk Weiße Rose")
```

```{r Auswahl Edge-Attribute}

edge.attributes(wr)$relationship
edge.attributes(wr)$time
```

```{r Visualisierung nach Edge-Attribut time}

# setzt den Wert rot für alle Werte 1 = vor Flugblatt 1 ---
edge.attributes(wr)$time
plot(wr, edge.color=c("red", "black")[(E(s)$relation=="1")+1])
```

```{r Auswahl Vertex-Attribute}

list.vertex.attributes(wr)
vertex.attributes(wr)$name
vertex.attributes(wr)$sex
vertex.attributes(wr)$age
vertex.attributes(wr)$hometown
vertex.attributes(wr)$occupation
```

```{r Visualisierung Vertex-Attribut sex}

# setzt den Wert blau für sex 1 und orange für sex 2 ein
vertex.attributes(wr)$sex
V(wr)[V(wr)$sex=="1"]$color <- "lightblue"
V(wr)[V(wr)$sex=="2"]$color <- "orange"
plot(wr, 
     layout=layout_nicely, 
     main="Gesamtnetzwerk Weiße Rose",
     sub="Vertex-Attribut sex=1 (männlich) auf lightblue, sex=2 (weiblich) auf orange gesetzt")
```

```{r Cluster}

# Vorbereitung für Cluster-Berechnung
?cluster_walktrap
wr
gc <- cluster_walktrap(wr)
modularity(gc)
membership(gc)
par(mfrow=c(1,1), mar=c(0,0,1,2))
plot(gc, wr, edge.arrow.size=.2, main="Clusteranalyse des Gesamtnetzwerks")

```

```{r Berechnung der degrees}

degree(wr)
```

```{r Visualisierung Vertex-Attribut hometown}

# setzt den Wert blau=München(1), rot=Ulm(3), grün=Hamburg(4), pink=Stuttgart(7) ein
vertex.attributes(wr)$hometown
V(wr)[V(wr)$hometown=="1"]$color <- "blue"
V(wr)[V(wr)$hometown=="3"]$color <- "red"
V(wr)[V(wr)$hometown=="4"]$color <- "green"
V(wr)[V(wr)$hometown=="7"]$color <- "yellow"
plot(wr, 
     layout=layout_nicely, 
     main="Gesamtnetzwerk Weiße Rose",
     sub="Vertex-Attribut hometown blau=München(1), rot=Ulm(3), grün=Hamburg(4), yellow=Stuttgart(7)")
```

